var taskr=angular.module("taskr",["ngRoute"]);taskr.config(["$routeProvider",function(t){t.when("/",{templateUrl:"views/index.html",controller:"indexCtrl"}).when("/:companyId",{templateUrl:"views/tasks.html",controller:"taskCtrl"}).otherwise(function(t){t.path("/")})}]),taskr.controller("appbarCtrl",function(t){t.exit=function(){window.close()}}),taskr.controller("companiesCtrl",function(t){t.companies=db.query("companies"),t.show_add=function(){document.getElementById("add-company-sidebar").setAttribute("class","show")},t.hide_add=function(){document.getElementById("add-company-sidebar").setAttribute("class","")},t.add=function(){if(0!=t.name.length){var e={name:t.name,hourly_rate:t.hourly_rate,currency:t.currency},n=db.insert("companies",e);db.commit(),e.ID=n,t.hide_add(),t.companies.push(e)}}}),taskr.controller("indexCtrl",function(){}),taskr.controller("taskCtrl",function(t,e,n){t.company=db.query("companies",{ID:n.companyId})[0],t.tasks=db.query("tasks",{company:n.companyId});for(var r=0;r<t.tasks.length;r++)t.tasks[r].entries=db.query("entries",{task:t.tasks[r].ID});t.time_spent=function(t,e){var n=new Date(t.started_at),r=new Date(t.ended_at),o=(r-n)/1e3/60;return o="minutes"==e?o:o/60,Math.round(o)},t.total_time=function(e){var n=db.query("entries",{task:e.ID}),o=0;for(r=0;r<n.length;r++)o+=t.time_spent(n[r],"hours");return o},t.add=function(){if(0!=t.title.length){var e={company:n.companyId,title:t.title,description:t.description,complete:!1};db.insert("tasks",e),db.commit(),t.tasks.push(e)}}});